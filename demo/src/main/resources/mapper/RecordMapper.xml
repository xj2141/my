<?xml version = "1.0" encoding = "UTF-8"?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD com.example.Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.demo.dao.RecordDao">

    <resultMap id="resultPre" type="com.example.demo.domain.PreRecord">
        <result property="recordDate" column="recordDate" />
        <result property="wakeTime" column="wakeTime"/>
        <result property="sleepTime" column="sleepTime"/>
        <result property="beginId" column="beginId"/>
        <result property="endId" column="endId"/>
    </resultMap>

    <resultMap id="resultSuf" type="com.example.demo.domain.SufRecord">
        <id property="recordId" column="recordId" />
        <result property="flowTime" column="flowTime"/>
        <result property="capacity" column="capacity"/>
        <result property="flowFastYN" column="flowFastYN"/>
        <result property="flowLeakYN" column="flowLeakYN"/>
        <result property="remark" column="remark"/>
    </resultMap>

    <select id="getPre" resultMap="resultPre">
        select * from preRecord
    </select>

    <select id="getPreByDate" resultMap="resultPre" parameterType="String">
        select * from preRecord
        where recordDate=#{recordDate}
    </select>

    <insert id="insertPre" parameterType="com.example.demo.domain.PreRecord">
        insert into preRecord(recordDate,wakeTime,sleepTime,beginId,endId)
        values (
        #{recordDate,jdbcType=VARCHAR},
        #{wakeTime,jdbcType=VARCHAR},
        #{sleepTime,jdbcType=VARCHAR},
        #{beginId,jdbcType=INTEGER},
        #{endId,jdbcType=INTEGER}
        )
    </insert>

    <delete id="removePre">
        delete from preRecord where recordDate in
        <foreach collection="array" item="recordDate" open="(" separator="," close=")">
            #{recordDate}
        </foreach>
    </delete>

    <select id="getSuf" resultMap="resultSuf">
        select * from sufRecord
        where recordId between #{beginId} AND #{endId}
    </select>

    <select id="getLastIdSuf" resultType="Integer">
        select recordId from sufRecord
        order by recordId desc
        limit 0,1
    </select>

    <insert id="insertTempSuf">
        insert into sufRecord(flowTime,capacity,flowFastYN,flowLeakYN,remark)
        select flowTime,capacity,flowFastYN,flowLeakYN,remark from tempSufRecord
    </insert>

    <insert id="insertSuf" parameterType="java.util.List">
        insert into sufRecord(flowTime,capacity,flowFastYN,flowLeakYN,remark)
        values
        <foreach collection="list"  item="item" index="index" separator=",">
            (
            #{item.flowTime,jdbcType=VARCHAR},
            #{item.capacity,jdbcType=VARCHAR},
            #{item.flowFastYN,jdbcType=VARCHAR},
            #{item.flowLeakYN,jdbcType=VARCHAR},
            #{item.remark,jdbcType=VARCHAR}
            )
        </foreach>
    </insert>

    <delete id="removeSuf">
        delete from sufRecord where recordId in
        <foreach collection="array" item="recordId" open="(" separator="," close=")">
            #{recordId}
        </foreach>
    </delete>
</mapper>